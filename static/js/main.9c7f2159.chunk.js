(this["webpackJsonpreact-complete-guide"]=this["webpackJsonpreact-complete-guide"]||[]).push([[0],{28:function(e,n,o){e.exports={pieceQueueMine:"PieceQueue_pieceQueueMine__1UxQY",pieceQueueOpponent:"PieceQueue_pieceQueueOpponent__1ygFA"}},31:function(e,n,o){e.exports={heldBlock:"HeldBlock_heldBlock__2nV0f",title:"HeldBlock_title__-UOyq"}},32:function(e,n,o){e.exports={stopWatch:"StopWatch_stopWatch__2hbXZ"}},36:function(e,n,o){e.exports={backdrop:"Modal_backdrop__2znzX",modal:"Modal_modal__2QgxK"}},37:function(e,n,o){e.exports={block:"Block_block__1kjjl",None:"Block_None__ltR1S",I:"Block_I__1Pnys",T:"Block_T__WdEBm",L:"Block_L__1zsbc",J:"Block_J__2iV29",Z:"Block_Z__28EjD",S:"Block_S__MKS_j",O:"Block_O__3X5pc",Ighost:"Block_Ighost__1pBKL",Tghost:"Block_Tghost__2h680",Lghost:"Block_Lghost__3KiXo",Jghost:"Block_Jghost__9BTwX",Zghost:"Block_Zghost__3ytmC",Sghost:"Block_Sghost__1z9Pj",Oghost:"Block_Oghost__34NVA"}},38:function(e,n,o){e.exports={pieceQueue:"PieceQueue_pieceQueue__N5gJS"}},40:function(e,n,o){e.exports={block:"Block_block__7hl6T",None:"Block_None__2PHRA",I:"Block_I__2hPz5",T:"Block_T__1zbV7",L:"Block_L__vPAnW",J:"Block_J__1lt8I",Z:"Block_Z__2BuFD",S:"Block_S__36R4_",O:"Block_O__1LvhJ",Ighost:"Block_Ighost__lbI0G",Tghost:"Block_Tghost__3-N71",Lghost:"Block_Lghost__2imGj",Jghost:"Block_Jghost__3QcrR",Zghost:"Block_Zghost__eEqpK",Sghost:"Block_Sghost__2Fbny",Oghost:"Block_Oghost__1cvVz"}},46:function(e,n,o){e.exports={grid:"Grid_grid__9Fsru"}},47:function(e,n,o){e.exports={howToPlay:"HowToPlay_howToPlay__2-hPX"}},48:function(e,n,o){e.exports={grid:"Grid_grid__3hTgC"}},49:function(e,n,o){e.exports={"nav-bar":"NavigationBar_nav-bar__WRYyO"}},62:function(e,n,o){},64:function(e,n,o){"use strict";o.r(n);var t=o(42),N=o.n(t),r=o(9),c=(o(62),o(13)),a=o(23),s=o(7),i=o(8),u=o.n(i),l=o(20),j=Object(l.b)({name:"controls",initialState:{newGame:"Escape",moveLeft:"ArrowLeft",moveRight:"ArrowRight",softDrop:"ArrowDown",hardDrop:" ",rotateLeft:"z",rotateRight:"ArrowUp",hold:"c"},reducers:{resetDefault:function(e){e.newGame="Escape",e.moveLeft="ArrowLeft",e.moveRight="ArrowRight",e.softDrop="ArrowDown",e.hardDrop=" ",e.rotateLeft="z",e.rotateRight="ArrowUp",e.hold="c"},resetAlbert:function(e){e.newGame="Escape",e.moveLeft="ArrowLeft",e.moveRight="ArrowRight",e.softDrop="ArrowDown",e.hardDrop=" ",e.rotateLeft="q",e.rotateRight="w",e.hold="Tab"},setNewControls:function(e,n){e.newGame=n.payload.newGame,e.moveLeft=n.payload.moveLeft,e.moveRight=n.payload.moveRight,e.softDrop=n.payload.softDrop,e.hardDrop=n.payload.hardDrop,e.rotateLeft=n.payload.rotateLeft,e.rotateRight=n.payload.rotateRight,e.hold=n.payload.hold}}}),d=j.actions,f=j.reducer,b=o(22),h=o(36),p=o.n(h),O=o(2),m=function(e){return Object(O.jsx)("div",{className:p.a.backdrop,onClick:e.onClick})},y=function(e){var n=e.children;return Object(O.jsx)("div",{className:p.a.modal,children:n})},g=function(e){var n=document.getElementById("overlays");return Object(O.jsxs)(i.Fragment,{children:[Object(b.createPortal)(Object(O.jsx)(m,{onClick:e.onClick}),n),Object(b.createPortal)(Object(O.jsx)(y,{children:e.children}),n)]})},v=function(e){var n=e.controlName,o=e.input,t=e.setInput,N=e.currentKey,r=Object(i.useState)(!1),a=Object(c.a)(r,2),s=a[0],u=a[1];Object(i.useEffect)((function(){document.onkeydown=function(e){s&&t(e.key)}}),[s]);var l=o;return" "===l&&(l="space"),Object(i.useEffect)((function(){t(N)}),[N]),Object(O.jsxs)("div",{children:[Object(O.jsx)("label",{id:n,children:"".concat(n," ")}),Object(O.jsx)("input",{onChange:function(e){1===e.target.value.length&&e.target.blur()},onFocus:function(e){t(""),u(!0)},onBlur:function(e){""===e.target.value&&t(N),u(!1)},id:n,value:l})]})},x=function(e){var n=e.setShowKeyBindings,o=Object(r.b)(),t=Object(r.c)((function(e){return e.controls})),N=Object(i.useState)(t.newGame),a=Object(c.a)(N,2),s=a[0],u=a[1],l=Object(i.useState)(t.rotateRight),j=Object(c.a)(l,2),f=j[0],b=j[1],h=Object(i.useState)(t.rotateLeft),p=Object(c.a)(h,2),m=p[0],y=p[1],x=Object(i.useState)(t.hold),P=Object(c.a)(x,2),C=P[0],S=P[1],L=Object(i.useState)(t.hardDrop),w=Object(c.a)(L,2),_=w[0],G=w[1],R=Object(i.useState)(t.softDrop),k=Object(c.a)(R,2),I=k[0],D=k[1],T=Object(i.useState)(t.moveLeft),A=Object(c.a)(T,2),B=A[0],E=A[1],M=Object(i.useState)(t.moveRight),K=Object(c.a)(M,2),F=K[0],U=K[1];return Object(O.jsxs)(g,{onClick:function(){n(!1)},children:[Object(O.jsx)("button",{onClick:function(){n(!1)},style:{float:"right"},children:"x"}),Object(O.jsx)(v,{controlName:"newGame",currentKey:t.newGame,input:s,setInput:u}),Object(O.jsx)(v,{currentKey:t.rotateRight,controlName:"rotateRight",input:f,setInput:b}),Object(O.jsx)(v,{currentKey:t.rotateLeft,controlName:"rotateLeft",input:m,setInput:y}),Object(O.jsx)(v,{currentKey:t.hold,controlName:"hold",input:C,setInput:S}),Object(O.jsx)(v,{currentKey:t.hardDrop,controlName:"hardDrop",input:_,setInput:G}),Object(O.jsx)(v,{currentKey:t.softDrop,controlName:"softDrop",input:I,setInput:D}),Object(O.jsx)(v,{currentKey:t.moveLeft,controlName:"moveLeft",input:B,setInput:E}),Object(O.jsx)(v,{currentKey:t.moveRight,controlName:"moveRight",input:F,setInput:U}),Object(O.jsxs)("div",{children:[Object(O.jsx)("button",{onClick:function(){o(d.resetDefault())},children:"Default"}),Object(O.jsx)("button",{onClick:function(){o(d.resetAlbert())},children:"Albert"}),Object(O.jsx)("button",{onClick:function(){o(d.setNewControls({newGame:s,rotateRight:f,rotateLeft:m,hardDrop:_,softDrop:I,moveLeft:B,moveRight:F,hold:C}))},children:"Save"})]})]})},P=o(0),C=o(3),S=o(45),L=(Object(S.a)({apiKey:"AIzaSyA9ipNK6_boqbwThQlJgolni-O5iIgIl40",authDomain:"ditris-2244c.firebaseapp.com",databaseURL:"https://ditris-2244c-default-rtdb.firebaseio.com",projectId:"ditris-2244c",storageBucket:"ditris-2244c.appspot.com",messagingSenderId:"743373731037",appId:"1:743373731037:web:9552a80db8b0df8d875734"}),Object(a.a)()),w=Object(s.c)(),_=Object(s.j)(w),G=Object(s.a)(_,"users"),R=Object(s.a)(_,"rooms"),k=function(){var e=Object(C.a)(Object(P.a)().mark((function e(n){var o;return Object(P.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(s.b)(Object(s.a)(G,n)).then((function(e){o=e.val().username}));case 2:return e.abrupt("return",o);case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),I=o(14),D=o(10),T={I:[[[1,1,1,1],[0,0,0,0]],[[0,0,1,0],[0,0,1,0],[0,0,1,0],[0,0,1,0]],[[0,0,0,0],[0,0,0,0],[1,1,1,1],[0,0,0,0]],[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]]],T:[[[0,1,0],[1,1,1]],[[0,1,0],[0,1,1],[0,1,0]],[[0,0,0],[1,1,1],[0,1,0]],[[0,1,0],[1,1,0],[0,1,0]]],L:[[[0,0,1],[1,1,1]],[[0,1,0],[0,1,0],[0,1,1]],[[0,0,0],[1,1,1],[1,0,0]],[[1,1,0],[0,1,0],[0,1,0]]],J:[[[1,0,0],[1,1,1]],[[0,1,1],[0,1,0],[0,1,0]],[[0,0,0],[1,1,1],[0,0,1]],[[0,1,0],[0,1,0],[1,1,0]]],Z:[[[1,1,0],[0,1,1]],[[0,0,1],[0,1,1],[0,1,0]],[[0,0,0],[1,1,0],[0,1,1]],[[0,1,0],[1,1,0],[1,0,0]]],S:[[[0,1,1],[1,1,0]],[[0,1,0],[0,1,1],[0,0,1]],[[0,0,0],[0,1,1],[1,1,0]],[[1,0,0],[1,1,0],[0,1,0]]],O:[[[0,1,1],[0,1,1]],[[0,1,1],[0,1,1]],[[0,1,1],[0,1,1]],[[0,1,1],[0,1,1]]]},A=o(5),B=o(6),E=function(){function e(){Object(A.a)(this,e),this.elements={},this.head=0,this.tail=0}return Object(B.a)(e,[{key:"enqueue",value:function(e){this.elements[this.tail]=e,this.tail++}},{key:"dequeue",value:function(){var e=this.elements[this.head];return delete this.elements[this.head],this.head++,e}},{key:"peek",value:function(){return this.elements[this.head]}},{key:"empty",value:function(){for(;!this.isEmpty;)this.dequeue()}},{key:"length",get:function(){return this.tail-this.head}},{key:"isEmpty",get:function(){return 0===this.length}}]),e}(),M=["I","I","T","T","L","L","J","J","Z","Z","S","S","O","O"],K=function(){0===M.length&&(M=["I","I","T","T","L","L","J","J","Z","Z","S","S","O","O"]);var e=Math.floor(M.length*Math.random());return M.splice(e,1)},F=function(e,n,o,t){return T[e][n].map((function(e,n){return e.map((function(e,N){return e?{x:o+N,y:t+n}:null}))}))},U=function(e,n){var o,t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],N=[],r=Object(D.a)(n);try{for(r.s();!(o=r.n()).done;){var c,a=o.value,s=Object(D.a)(a);try{for(s.s();!(c=s.n()).done;){var i=c.value;i&&J(e,i,t)&&N.push(i)}}catch(u){s.e(u)}finally{s.f()}}}catch(u){r.e(u)}finally{r.f()}return N},Q=function(e){var n,o=Object(D.a)(e.currentCoords);try{for(o.s();!(n=o.n()).done;){var t=n.value;e.grid[t.y][t.x]="None"}}catch(N){o.e(N)}finally{o.f()}},Z=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(n){var o,t=e.currentShape+"ghost",N=Object(D.a)(e.ghostCoords);try{for(N.s();!(o=N.n()).done;){var r=o.value;e.grid[r.y][r.x]=t;var c,a=Object(D.a)(e.currentCoords);try{for(a.s();!(c=a.n()).done;){var s=c.value;s.y===r.y&&s.x===r.x&&(e.grid[r.y][r.x]=e.currentShape)}}catch(j){a.e(j)}finally{a.f()}}}catch(j){N.e(j)}finally{N.f()}}else{var i,u=Object(D.a)(e.currentCoords);try{for(u.s();!(i=u.n()).done;){var l=i.value;e.grid[l.y][l.x]=e.currentShape}}catch(j){u.e(j)}finally{u.f()}}},J=function(e,n){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(n&&n.y<=20&&n.x>=0&&n.x<=9){var t,N=Object(D.a)(e.currentCoords);try{for(N.s();!(t=N.n()).done;){var r=t.value;if(o&&r.y===n.y&&r.x===n.x)return!0}}catch(c){N.e(c)}finally{N.f()}if(e.grid[n.y][n.x].length>1)return!0}return!1},W=new E,q=Object(l.b)({name:"gameState",initialState:{gameRunning:!1,currentShape:null,currentCoords:[],ghostCoords:[],currentPieceState:"NONE",rotatePos:0,xPos:3,yPos:0,totalLinesCleared:0,grid:[["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"]],pieceQueue:null,isGameWon:!1,heldPiece:null,rotated:!1,displayMessage:null},reducers:{reset:function(e){M=["I","I","T","T","L","L","J","J","Z","Z","S","S","O","O"],e.grid=[["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"]],e.xPos=3,e.yPos=0,e.rotatePos=0,e.totalLinesCleared=0,e.displayMessage=null,e.rotated=!1,e.heldPiece=null,e.currentPieceState="GETTING READY",W.empty(),e.gameRunning=!1},newGame:function(e){M=["I","I","T","T","L","L","J","J","Z","Z","S","S","O","O"],e.grid=[["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"]],e.xPos=3,e.yPos=0,e.rotatePos=0,e.totalLinesCleared=0,e.rotated=!1,e.heldPiece=null,e.displayMessage="READY",e.currentPieceState="GETTING READY",W.empty(),e.gameRunning=!1},gettingReady:function(e){if("GETTING READY"===e.currentPieceState)e.currentPieceState="BEFORE START",e.displayMessage="GO!";else if("BEFORE START"===e.currentPieceState){e.displayMessage=null,e.gameRunning=!0,e.currentShape=K()[0];for(var n=0;n<5;n++)W.enqueue.apply(W,Object(I.a)(K()))}},clearLines:function(e){var n,o=[],t=0,N=Object(D.a)(e.grid);try{for(N.s();!(n=N.n()).done;){var r=n.value;r.every((function(e){return"None"!==e}))?(e.totalLinesCleared+=1,t+=1):o.push(r)}}catch(a){N.e(a)}finally{N.f()}for(var c=0;c<t;c++)o.unshift(["None","None","None","None","None","None","None","None","None","None"]);e.grid=o},getNewPiece:function(e){if(e.gameRunning){if(e.ghostCoords=[],e.rotated=!1,e.currentShape=W.dequeue(),W.enqueue.apply(W,Object(I.a)(K())),e.xPos=3,e.yPos=0,e.rotatePos=0,e.currentCoords=U(e,F(e.currentShape,e.rotatePos,e.xPos,e.yPos)),e.currentCoords.length<4)return e.gameRunning=!1,e.displayMessage="YOU LOST",void console.log("lost");Z(e),e.currentPieceState="FALLING"}},rotatePiece:function(e,n){var o=e.rotatePos;e.rotatePos=function(e,n){var o=n.rotatePos;return e?0===o?3:o-1:3===o?0:o+1}(n.payload,{rotatePos:e.rotatePos}),Q(e),e.currentCoords=U(e,F(e.currentShape,e.rotatePos,e.xPos,e.yPos)),e.currentCoords.length<4?(e.rotatePos=o,e.currentCoords=U(e,F(e.currentShape,e.rotatePos,e.xPos,e.yPos))):e.currentPieceState="FALLING",Z(e)},dropPiece:function(e){if(e.gameRunning){if("LANDING"===e.currentPieceState)return void(e.currentPieceState="FROZEN");Q(e),e.yPos+=1,e.currentCoords=U(e,F(e.currentShape,e.rotatePos,e.xPos,e.yPos)),e.currentCoords.length<4?(e.yPos-=1,e.currentCoords=U(e,F(e.currentShape,e.rotatePos,e.xPos,e.yPos)),e.currentPieceState="LANDING"):e.currentPieceState="FALLING",Z(e)}},getGhostCoords:function(e){if(e.gameRunning){!function(e){var n,o=Object(D.a)(e.ghostCoords);try{for(o.s();!(n=o.n()).done;){var t=n.value;e.grid[t.y][t.x]="None"}}catch(N){o.e(N)}finally{o.f()}}(e),e.ghostCoords=[];var n,o=Object(D.a)(e.currentCoords);try{for(o.s();!(n=o.n()).done;){var t=n.value;e.ghostCoords.push({x:t.x,y:t.y})}}catch(r){o.e(r)}finally{o.f()}for(var N=e.yPos;4===e.ghostCoords.length;)N+=1,e.ghostCoords=U(e,F(e.currentShape,e.rotatePos,e.xPos,N),!0);N-=1,e.ghostCoords=U(e,F(e.currentShape,e.rotatePos,e.xPos,N),!0)}},hardDrop:function(e){Q(e),e.currentCoords=e.ghostCoords,Z(e),e.currentPieceState="FROZEN"},showGhostPiece:function(e){e.gameRunning&&Z(e,!0)},shiftLeft:function(e){Q(e),e.xPos-=1,e.currentCoords=U(e,F(e.currentShape,e.rotatePos,e.xPos,e.yPos)),e.currentCoords.length<4?(e.xPos+=1,e.currentCoords=U(e,F(e.currentShape,e.rotatePos,e.xPos,e.yPos))):e.currentPieceState="FALLING",Z(e)},shiftRight:function(e){Q(e),e.xPos+=1,e.currentCoords=U(e,F(e.currentShape,e.rotatePos,e.xPos,e.yPos)),e.currentCoords.length<4?(e.xPos-=1,e.currentCoords=U(e,F(e.currentShape,e.rotatePos,e.xPos,e.yPos))):e.currentPieceState="FALLING",Z(e)},checkIfGameWon:function(e){e.totalLinesCleared>=4&&(console.log("won"),e.isGameWon=!0,e.gameRunning=!1,e.displayMessage="YOU WON")},holdPiece:function(e){if(!0!==e.rotated){if(e.rotated=!0,Q(e),null===e.heldPiece)e.heldPiece=e.currentShape,e.currentShape=W.dequeue(),W.enqueue.apply(W,Object(I.a)(K()));else{var n=e.currentShape;e.currentShape=e.heldPiece,e.heldPiece=n}e.xPos=3,e.yPos=0,e.rotatePos=0,e.currentCoords=U(e,F(e.currentShape,e.rotatePos,e.xPos,e.yPos)),Z(e),e.currentPieceState="FALLING"}}}}),H=q.actions,z=q.reducer,Y=o(46),V=o.n(Y),X=o(37),$=o.n(X),ee=function(e){var n=e.color;return Object(O.jsx)("td",{className:"".concat($.a.block,"  ").concat($.a[n])})},ne=function(){var e=Object(r.c)((function(e){return e.gameState}));return Object(O.jsx)("div",{style:{position:"absolute",color:"yellow",marginTop:200,fontSize:"300%",flexDirection:"column"},children:e.displayMessage})},oe=function(){var e=Object(r.c)((function(e){return e.gameState})).grid.slice(1).map((function(e,n){return Object(O.jsx)("tr",{children:e.map((function(e,n){return Object(O.jsx)(ee,{color:e},n)}))},n)}));return Object(O.jsxs)("table",{className:V.a.grid,children:[Object(O.jsx)("tbody",{children:e}),Object(O.jsx)(ne,{})]})},te=function(e){var n=T[e.color][0].map((function(n,o){return Object(O.jsx)("tr",{children:n.map((function(n,o){return 0===n?Object(O.jsx)(ee,{color:null},o):Object(O.jsx)(ee,{color:e.color},o)}))},o)}));return Object(O.jsx)("li",{children:Object(O.jsx)("table",{children:Object(O.jsx)("tbody",{children:n})})})},Ne=o(38),re=o.n(Ne),ce=function(e){Object(r.c)((function(e){return e.gameState.heldPiece}));var n=0,o=[];if(W.isEmpty)return Object(O.jsx)("ul",{className:re.a.pieceQueue});for(var t in W.elements)o.push(Object(O.jsx)(te,{color:W.elements[t]},n++));return Object(O.jsx)("ul",{className:re.a.pieceQueue,children:o})},ae=o(31),se=o.n(ae),ie=function(){var e=Object(r.c)((function(e){return e.gameState}));if(!e.heldPiece)return Object(O.jsx)("div",{className:se.a.heldBlock,children:Object(O.jsx)("table",{children:Object(O.jsxs)("tbody",{children:[Object(O.jsxs)("tr",{children:[Object(O.jsx)(ee,{}),Object(O.jsx)(ee,{}),Object(O.jsx)(ee,{}),Object(O.jsx)(ee,{})]}),Object(O.jsxs)("tr",{children:[Object(O.jsx)(ee,{}),Object(O.jsx)(ee,{}),Object(O.jsx)(ee,{}),Object(O.jsx)(ee,{})]}),Object(O.jsxs)("tr",{children:[Object(O.jsx)(ee,{}),Object(O.jsx)(ee,{}),Object(O.jsx)(ee,{}),Object(O.jsx)(ee,{})]})]})})});var n=T[e.heldPiece][0].map((function(n,o){return Object(O.jsx)("tr",{children:n.map((function(n,o){return 0===n?Object(O.jsx)(ee,{color:null},o):Object(O.jsx)(ee,{color:e.heldPiece},o)}))},o)}));return Object(O.jsx)("div",{className:se.a.heldBlock,children:Object(O.jsxs)("table",{children:[Object(O.jsx)("div",{className:se.a.title,children:"Held Piece"}),Object(O.jsx)("tbody",{children:n})]})})},ue={},le={},je={},de=function(){window.addEventListener("keydown",(function(e){ue[e.key]=!0,"Tab"===e.key&&(e.preventDefault(),e.stopPropagation())," "===e.key&&(e.preventDefault(),e.stopPropagation()),"ArrowDown"===e.key&&(e.preventDefault(),e.stopPropagation()),"ArrowUp"===e.key&&(e.preventDefault(),e.stopPropagation())})),window.addEventListener("keyup",(function(e){je[e.key]=0,ue[e.key]=!1,le[e.key]=!1}))},fe=o(47),be=o.n(fe),he=function(){return Object(O.jsx)("div",{className:be.a.howToPlay})},pe=o(32),Oe=o.n(pe),me=function(){var e=Object(r.c)((function(e){return e.gameState.gameRunning})),n=Object(i.useState)(0),o=Object(c.a)(n,2),t=o[0],N=o[1],a=Object(i.useState)(0),s=Object(c.a)(a,2),u=s[0],l=s[1],j=Object(i.useState)(0),d=Object(c.a)(j,2),f=d[0],b=d[1];return Object(i.useEffect)((function(){var n=null;return e&&(N((function(){return 0})),l((function(){return 0})),b((function(){return 0})),n=setInterval((function(){N((function(e){return e+1}))}),100)),function(){clearInterval(n)}}),[e]),10===t&&(l(u+1),N(0)),60===u&&(b(f+1),l(0)),f?Object(O.jsx)("div",{className:Oe.a.stopWatch,children:"Time ".concat(f,":").concat(u,":").concat(t)}):u?Object(O.jsx)("div",{className:Oe.a.stopWatch,children:"Time ".concat(u,":").concat(t)}):t?Object(O.jsx)("div",{className:Oe.a.stopWatch,children:"Time 0:".concat(t)}):void 0},ye=!1,ge=function(){var e=Object(r.b)(),n=Object(r.c)((function(e){return e.gameState.gameRunning})),o=Object(r.c)((function(e){return e.gameState.currentPieceState})),t=Object(r.c)((function(e){return e.gameState.displayMessage})),N=Object(r.c)((function(e){return e.controls})),a=Object(i.useState)(!1),s=Object(c.a)(a,2),u=s[0],l=s[1];Object(i.useEffect)((function(){var t=window.setInterval((function(){n&&("FROZEN"===o?(e(H.clearLines()),e(H.checkIfGameWon()),e(H.getNewPiece()),e(H.getGhostCoords()),e(H.showGhostPiece())):(e(H.dropPiece()),e(H.getGhostCoords()),e(H.showGhostPiece())))}),300),N=window.setInterval((function(){d()}),1),r=window.setInterval((function(){j()}),1);return function(){window.clearInterval(t),window.clearInterval(N),window.clearInterval(r)}})),Object(i.useEffect)((function(){if(u){var n=window.setInterval((function(){e(H.gettingReady())}),500);return function(){window.clearInterval(n)}}}),[t,e,u]);var j=function(){if(n&&!ye){for(var o in je)je[o]&&(je[o]+=1);ue[N.softDrop]&&le[N.softDrop]&&je[N.softDrop]>40&&(e(H.dropPiece()),le[N.softDrop]=!0,je[N.softDrop]=30),ue[N.moveRight]&&le[N.moveRight]&&je[N.moveRight]>40&&(e(H.shiftRight()),e(H.getGhostCoords()),e(H.showGhostPiece()),le[N.moveRight]=!0,je[N.moveRight]=30),ue[N.moveLeft]&&le[N.moveLeft]&&je[N.moveLeft]>40&&(e(H.shiftLeft()),e(H.getGhostCoords()),e(H.showGhostPiece()),le[N.moveLeft]=!0,je[N.moveLeft]=30)}},d=function(){n&&!ye&&(ue[N.rotateLeft]&&!le[N.rotateLeft]&&(e(H.rotatePiece(!0)),e(H.getGhostCoords()),e(H.showGhostPiece()),le[N.rotateLeft]=!0),ue[N.rotateRight]&&!le[N.rotateRight]&&(e(H.rotatePiece(!1)),e(H.getGhostCoords()),e(H.showGhostPiece()),le[N.rotateRight]=!0),ue[N.hardDrop]&&!le[N.hardDrop]&&(ye=!0,e(H.hardDrop()),le[N.hardDrop]=!0,setTimeout((function(){ye=!1}),350)),ue[N.hold]&&!le[N.hold]&&(e(H.holdPiece()),e(H.getGhostCoords()),e(H.showGhostPiece()),le[N.hold]=!0),ue[N.softDrop]&&!le[N.softDrop]&&(je[N.softDrop]=1,e(H.dropPiece()),le[N.softDrop]=!0),ue[N.moveRight]&&!le[N.moveRight]&&(je[N.moveRight]=1,e(H.shiftRight()),e(H.getGhostCoords()),e(H.showGhostPiece()),le[N.moveRight]=!0),ue[N.moveLeft]&&!le[N.moveLeft]&&(je[N.moveLeft]=1,e(H.shiftLeft()),e(H.getGhostCoords()),e(H.showGhostPiece()),le[N.moveLeft]=!0))};return document.onkeydown=function(n){n.key===N.newGame&&(l(!0),e(H.newGame()),e(H.getGhostCoords()),e(H.showGhostPiece()))},Object(O.jsxs)(i.Fragment,{children:[Object(O.jsx)(de,{}),Object(O.jsxs)("div",{style:{display:"flex",flexWrap:"nowrap"},children:[Object(O.jsx)(ie,{}),Object(O.jsx)(oe,{}),Object(O.jsx)(ce,{})]}),Object(O.jsx)(me,{}),Object(O.jsx)(he,{})]})},ve=function(){return Object(O.jsxs)(i.Fragment,{children:[Object(O.jsx)("h1",{children:"Ditris"}),Object(O.jsx)(ge,{})]})},xe=o(39),Pe=o(21),Ce=function(){var e=Object(r.c)((function(e){return e.userInfo.isLoggedIn})),n=Object(i.useState)(""),o=Object(c.a)(n,2),t=o[0],N=o[1],a=function(){var e=Object(C.a)(Object(P.a)().mark((function e(n){return Object(P.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,Object(xe.a)(L);case 3:Object(Pe.e)(Object(Pe.a)(G,L.currentUser.uid),{username:t,inRoom:!1}),N("");case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),s=function(){var e=Object(C.a)(Object(P.a)().mark((function e(){return Object(P.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(Pe.d)(Object(Pe.a)(G,L.currentUser.uid)),Object(xe.b)(L);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return e?Object(O.jsx)("button",{onClick:s,children:"Logout"}):Object(O.jsxs)("form",{onSubmit:a,children:[Object(O.jsx)("label",{id:"name",children:"Username: "}),Object(O.jsx)("input",{id:"name",value:t,onChange:function(e){N(e.target.value)}}),Object(O.jsx)("button",{children:"Login"})]})},Se=Object(i.memo)(Ce),Le=null,we=Object(l.b)({name:"UserInfo",initialState:{isLoggedIn:!1,roomStatus:null,otherUsers:[],roomKey:null,opponentName:"",opponentID:null,invitationKeys:[],grid:[],displayText:""},reducers:{reset:function(e){e.roomStatus="looking for room",e.otherUsers=[],e.roomKey=null,e.opponentName="",e.opponentID=null,e.invitationKeys=[],e.grid=[],e.myName="",Le=null},login:function(e){e.isLoggedIn=!0},logout:function(e){e.isLoggedIn=!1},setOtherUsers:function(e,n){e.otherUsers=n.payload},setRoomKey:function(e,n){e.roomKey=n.payload},setRoomStatus:function(e,n){e.roomStatus=n.payload},setOpponentName:function(e,n){e.opponentName=n.payload},setOpponentid:function(e,n){n.payload&&(Le=Object(s.a)(G,n.payload)),e.opponentID=n.payload},setInvitiationKeys:function(e,n){e.invitationKeys=n.payload},setGrid:function(e,n){e.grid=n},setDisplayText:function(e,n){e.displayText=n.payload}}}),_e=we.actions,Ge=we.reducer,Re=function(e){var n=e.username,o=e.uid,t=Object(r.b)(),N=Object(Pe.c)(R),c=function(){var e=Object(C.a)(Object(P.a)().mark((function e(){return Object(P.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(Pe.b)(R),e.next=3,Object(Pe.e)(N,{player1:L.currentUser.uid,player2:o,accepted:!1});case 3:t(_e.setRoomStatus("waiting")),t(_e.setRoomKey(N.key)),t(_e.setOpponentName(n)),t(_e.setOpponentid(o));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(O.jsx)("li",{children:Object(O.jsx)("button",{onClick:c,children:n})})},ke=function(){var e=Object(r.c)((function(e){return e.userInfo.otherUsers})),n=e?e.map((function(e,n){return Object(O.jsx)(Re,{username:e[1].username,uid:e[0]},n)})):null;if(n)return Object(O.jsx)("ul",{children:n})},Ie=Object(i.memo)(ke),De=function(e){var n=e.cancelRoomHandler,o=Object(r.c)((function(e){return e.userInfo.opponentName}));Object(r.c)((function(e){return e.userInfo.roomKey}));return Object(O.jsxs)(g,{children:["Waiting for ",o," to join",Object(O.jsx)("button",{onClick:n,children:"Cancel"})]})},Te=Object(i.memo)(De),Ae=["I","I","T","T","L","L","J","J","Z","Z","S","S","O","O"],Be=function(){0===Ae.length&&(Ae=["I","I","T","T","L","L","J","J","Z","Z","S","S","O","O"]);var e=Math.floor(Ae.length*Math.random());return Ae.splice(e,1)},Ee=function(e,n,o,t){return T[e][n].map((function(e,n){return e.map((function(e,N){return e?{x:o+N,y:t+n}:null}))}))},Me=function(e,n){var o,t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],N=[],r=Object(D.a)(n);try{for(r.s();!(o=r.n()).done;){var c,a=o.value,s=Object(D.a)(a);try{for(s.s();!(c=s.n()).done;){var i=c.value;i&&Ze(e,i,t)&&N.push(i)}}catch(u){s.e(u)}finally{s.f()}}}catch(u){r.e(u)}finally{r.f()}return N},Ke=null,Fe=new E,Ue=function(e){var n,o=Object(D.a)(e.myCurrentCoords);try{for(o.s();!(n=o.n()).done;){var t=n.value;e.grid[t.y][t.x]="None"}}catch(N){o.e(N)}finally{o.f()}},Qe=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(n){var o,t=e.myCurrentShape+"ghost",N=Object(D.a)(e.myGhostCoords);try{for(N.s();!(o=N.n()).done;){var r=o.value;e.grid[r.y][r.x]=t;var c,a=Object(D.a)(e.myCurrentCoords);try{for(a.s();!(c=a.n()).done;){var s=c.value;s.y===r.y&&s.x===r.x&&(e.grid[r.y][r.x]=e.myCurrentShape)}}catch(j){a.e(j)}finally{a.f()}}}catch(j){N.e(j)}finally{N.f()}}else{var i,u=Object(D.a)(e.myCurrentCoords);try{for(u.s();!(i=u.n()).done;){var l=i.value;e.grid[l.y][l.x]=e.myCurrentShape}}catch(j){u.e(j)}finally{u.f()}}},Ze=function(e,n){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(n&&n.y<=20&&n.x>=0&&n.x<=9){var t,N=Object(D.a)(e.myCurrentCoords);try{for(N.s();!(t=N.n()).done;){var r=t.value;if(o&&r.y===n.y&&r.x===n.x)return!0}}catch(c){N.e(c)}finally{N.f()}if(e.grid[n.y][n.x].length>1)return!0}return!1},Je=Object(l.b)({name:"gameState2",initialState:{playerNumber:null,gameRunning:!1,myCurrentShape:null,myCurrentCoords:[],myGhostCoords:[],myPieceQueue:null,myHeldPiece:null,myLinesCleared:0,opponentPieceQueue:[],opponentHeldPiece:null,opponentLinesCleared:0,currentGameStatus:"NONE",rotatePos:0,xPos:3,yPos:0,grid:[["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"]],rotated:!1,displayMessage:"",myTurn:null,linesToClear:10},reducers:{reset:function(e){e.playerNumber=null,e.gameRunning=!1,e.myCurrentShape=null,e.myCurrentCoords=[],e.myGhostCoords=[],e.myPieceQueue=null,e.myHeldPiece=null,e.myLinesCleared=0,e.opponentPieceQueue=[],e.opponentHeldPiece=null,e.opponentLinesCleared=0,e.currentGameStatus="NONE",e.rotatePos=0,e.xPos=3,e.yPos=0,e.grid=[["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"]],e.rotated=!1,e.displayMessage="",e.myTurn=null,e.linesToClear=10,Ke=null},setGrid:function(e,n){e.grid=n.payload},sendGrid:function(e){Object(s.l)(Object(s.a)(Ke,"grid"),e.grid)},gettingReady:function(e){e.myCurrentShape=null,e.myCurrentCoords=[],e.myGhostCoords=[],e.myPieceQueue=null,e.myHeldPiece=null,e.myLinesCleared=0,e.currentGameStatus="NONE",e.grid=[["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"]],Fe=new E,Object(s.l)(Object(s.a)(Ke,"player".concat(e.playerNumber,"GameInfo")),{gameQueue:Fe.elements,linesCleared:e.myLinesCleared})},newGame:function(e){e.xPos=3,e.yPos=0,e.rotatePos=0,Ae=["I","I","T","T","L","L","J","J","Z","Z","S","S","O","O"];for(var n=0;n<5;n++){var o;(o=Fe).enqueue.apply(o,Object(I.a)(Be()))}Object(s.l)(Object(s.a)(Ke,"player".concat(e.playerNumber,"GameInfo")),{gameQueue:Fe.elements,linesCleared:e.myLinesCleared})},setOpponentInfo:function(e,n){e.opponentPieceQueue=n.payload.opponentPieceQueue,e.opponentLinesCleared=n.payload.opponentLinesCleared},clearLines:function(e){var n,o=[],t=0,N=Object(D.a)(e.grid);try{for(N.s();!(n=N.n()).done;){var r=n.value;r.every((function(e){return"None"!==e}))?(e.myLinesCleared+=1,t+=1):o.push(r)}}catch(a){N.e(a)}finally{N.f()}for(var c=0;c<t;c++)o.unshift(["None","None","None","None","None","None","None","None","None","None"]);e.grid=o,Object(s.l)(Object(s.a)(Ke,"grid"),e.grid),Object(s.d)(Object(s.a)(Ke,"player".concat(e.playerNumber,"GameInfo/linesCleared"))),Object(s.l)(Object(s.a)(Ke,"player".concat(e.playerNumber,"GameInfo/linesCleared")),e.myLinesCleared)},placeCurrentPiece:function(e){Qe(e),Object(s.l)(Object(s.a)(Ke,"grid"),e.grid)},unfreeze:function(e){e.currentGameStatus="FALLING"},getNewPiece:function(e,n){var o,t;(e.myGhostCoords=[],e.myCurrentShape=Fe.dequeue(),(o=Fe).enqueue.apply(o,Object(I.a)(Be())),e.xPos=3,e.yPos=0,e.rotatePos=0,e.myCurrentCoords=Me(e,Ee(e.myCurrentShape,e.rotatePos,e.xPos,e.yPos)),e.myCurrentCoords.length<4)&&(e.grid=[["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"]],e.myCurrentShape=Fe.dequeue(),(t=Fe).enqueue.apply(t,Object(I.a)(Be())),Object(s.d)(Object(s.a)(Ke,"player".concat(1===e.playerNumber?2:1,"GameInfo"))),Object(s.l)(Object(s.a)(Ke,"player".concat(1===e.playerNumber?2:1,"GameInfo/linesCleared")),e.opponentLinesCleared-1),Object(s.d)(Object(s.a)(Ke,"displayMessage")),e.displayMessage="".concat(n.payload," CAUSED OVERFLOW"),Object(s.l)(Object(s.a)(Ke,"displayMessage"),"".concat(n.payload," CAUSED OVERFLOW")),setTimeout((function(){Object(s.l)(Object(s.a)(Ke,"displayMessage"),"in game")}),1e3),e.myCurrentCoords=Me(e,Ee(e.myCurrentShape,e.rotatePos,e.xPos,e.yPos)));Qe(e),Object(s.l)(Object(s.a)(Ke,"player".concat(e.playerNumber,"GameInfo/gameQueue")),Fe.elements),e.currentGameStatus="FALLING"},rotatePiece:function(e,n){var o=e.rotatePos;e.rotatePos=function(e,n){var o=n.rotatePos;return e?0===o?3:o-1:3===o?0:o+1}(n.payload,{rotatePos:e.rotatePos}),Ue(e),e.myCurrentCoords=Me(e,Ee(e.myCurrentShape,e.rotatePos,e.xPos,e.yPos)),e.myCurrentCoords.length<4?(e.rotatePos=o,e.myCurrentCoords=Me(e,Ee(e.myCurrentShape,e.rotatePos,e.xPos,e.yPos))):e.currentGameStatus="FALLING",Qe(e)},dropPiece:function(e){if(e.gameRunning){if("LANDING"===e.currentGameStatus)return void(e.currentGameStatus="FROZEN");Ue(e),e.yPos+=1,e.myCurrentCoords=Me(e,Ee(e.myCurrentShape,e.rotatePos,e.xPos,e.yPos)),e.myCurrentCoords.length<4?(e.yPos-=1,e.myCurrentCoords=Me(e,Ee(e.myCurrentShape,e.rotatePos,e.xPos,e.yPos)),e.currentGameStatus="LANDING"):e.currentGameStatus="FALLING",Qe(e)}},getGhostCoords:function(e){!function(e){var n,o=Object(D.a)(e.myGhostCoords);try{for(o.s();!(n=o.n()).done;){var t=n.value;e.grid[t.y][t.x]="None"}}catch(N){o.e(N)}finally{o.f()}}(e),e.myGhostCoords=[];var n,o=Object(D.a)(e.myCurrentCoords);try{for(o.s();!(n=o.n()).done;){var t=n.value;e.myGhostCoords.push({x:t.x,y:t.y})}}catch(r){o.e(r)}finally{o.f()}for(var N=e.yPos;4===e.myGhostCoords.length;)N+=1,e.myGhostCoords=Me(e,Ee(e.myCurrentShape,e.rotatePos,e.xPos,N),!0);N-=1,e.myGhostCoords=Me(e,Ee(e.myCurrentShape,e.rotatePos,e.xPos,N),!0)},hardDrop:function(e){Ue(e),e.myCurrentCoords=e.myGhostCoords,Qe(e),e.currentGameStatus="FROZEN"},showGhostPiece:function(e){Qe(e,!0),Object(s.l)(Object(s.a)(Ke,"grid"),e.grid)},shiftLeft:function(e){Ue(e),e.xPos-=1,e.myCurrentCoords=Me(e,Ee(e.myCurrentShape,e.rotatePos,e.xPos,e.yPos)),e.myCurrentCoords.length<4?(e.xPos+=1,e.myCurrentCoords=Me(e,Ee(e.myCurrentShape,e.rotatePos,e.xPos,e.yPos))):e.currentGameStatus="FALLING",Qe(e)},shiftRight:function(e){Ue(e),e.xPos+=1,e.myCurrentCoords=Me(e,Ee(e.myCurrentShape,e.rotatePos,e.xPos,e.yPos)),e.myCurrentCoords.length<4?(e.xPos-=1,e.myCurrentCoords=Me(e,Ee(e.myCurrentShape,e.rotatePos,e.xPos,e.yPos))):e.currentGameStatus="FALLING",Qe(e)},checkIfGameWon:function(e){e.myLinesCleared>=e.linesToClear&&(e.gameRunning=!1,e.displayMessage="PLAYER ".concat(e.playerNumber," WON"),k(L.currentUser.uid).then((function(e){Object(s.l)(Object(s.a)(Ke,"displayMessage"),"".concat(e," WON"))})))},holdPiece:function(e){if(!0!==e.rotated){if(e.rotated=!0,Ue(e),null===e.heldPiece){var n;e.heldPiece=e.currentShape,e.currentShape=Fe.dequeue(),(n=Fe).enqueue.apply(n,Object(I.a)(Be()))}else{var o=e.currentShape;e.currentShape=e.heldPiece,e.heldPiece=o}e.xPos=3,e.yPos=0,e.rotatePos=0,e.currentCoords=Me(e,Ee(e.currentShape,e.rotatePos,e.xPos,e.yPos)),Qe(e),e.currentPieceState="FALLING"}},setMultiplayer:function(e,n){e.playerNumber=n.payload.playerNumber,Ke=n.payload.roomRef},setDisplayMessage:function(e,n){e.displayMessage=n.payload,"in game"===e.displayMessage&&(e.gameRunning=!0),e.displayMessage.includes("WON")&&(e.gameRunning=!1,Object(s.l)(Object(s.a)(Ke,"turn"),null))},setMyTurn:function(e,n){e.myTurn=n.payload},setMyLinesCleared:function(e,n){e.myLinesCleared=n.payload},setLinesToClear:function(e,n){e.linesToClear=n.payload}}}),We=Je.actions,qe=Je.reducer,He=function(e){var n=e.roomKey,o=e.opponentuid,t=Object(r.b)(),N=Object(i.useState)(null),a=Object(c.a)(N,2),u=a[0],l=a[1],j=function(){var e=Object(C.a)(Object(P.a)().mark((function e(){return Object(P.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=l,e.next=3,k(o);case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),d=function(){var e=Object(C.a)(Object(P.a)().mark((function e(){return Object(P.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(s.l)(Object(s.a)(R,n+"/accepted"),!0);case 2:return e.next=4,Object(s.l)(Object(s.a)(R,n+"/displayMessage"),"");case 4:return t(_e.setOpponentid(o)),t(_e.setRoomStatus("in room")),t(_e.setRoomKey(n)),t(_e.setOpponentName(u)),t(We.setMultiplayer({playerNumber:2,roomRef:Object(s.a)(R,n)})),e.next=11,Object(s.l)(Object(s.a)(G,L.currentUser.uid+"/inRoom"),!0);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return j(),Object(O.jsx)("button",{onClick:d,children:u})},ze=function(){var e=Object(r.c)((function(e){return e.userInfo.invitationKeys}));return 0!==e.length&&(e=e.map((function(e,n){var o=e.roomKey,t=e.opponentuid;return Object(O.jsx)(He,{roomKey:o,opponentuid:t},n)}))),Object(O.jsx)("div",{children:e})},Ye=Object(i.memo)(ze),Ve=function(e){var n=e.leaveRoomHandler;return Object(O.jsx)("button",{onClick:n,children:"Leave Room"})},Xe=o(48),$e=o.n(Xe),en=o(40),nn=o.n(en),on=function(e){var n=e.color;return Object(O.jsx)("td",{className:"".concat(nn.a.block,"  ").concat(nn.a[n])})},tn=function(){var e=Object(r.c)((function(e){return e.gameState2.displayMessage}));return"in game"===e?void 0:Object(O.jsx)("div",{style:{position:"absolute",color:"yellow",marginTop:200,fontSize:"100%",flexDirection:"column"},children:e})},Nn=function(){var e=Object(r.c)((function(e){return e.gameState2})).grid.slice(1).map((function(e,n){return Object(O.jsx)("tr",{children:e.map((function(e,n){return Object(O.jsx)(on,{color:e},n)}))},n)}));return Object(O.jsxs)("table",{className:$e.a.grid,children:[Object(O.jsx)("tbody",{children:e}),Object(O.jsx)(tn,{})]})},rn={I:[[[1,1,1,1],[0,0,0,0]],[[0,0,1,0],[0,0,1,0],[0,0,1,0],[0,0,1,0]],[[0,0,0,0],[0,0,0,0],[1,1,1,1],[0,0,0,0]],[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]]],T:[[[0,1,0],[1,1,1]],[[0,1,0],[0,1,1],[0,1,0]],[[0,0,0],[1,1,1],[0,1,0]],[[0,1,0],[1,1,0],[0,1,0]]],L:[[[0,0,1],[1,1,1]],[[0,1,0],[0,1,0],[0,1,1]],[[0,0,0],[1,1,1],[1,0,0]],[[1,1,0],[0,1,0],[0,1,0]]],J:[[[1,0,0],[1,1,1]],[[0,1,1],[0,1,0],[0,1,0]],[[0,0,0],[1,1,1],[0,0,1]],[[0,1,0],[0,1,0],[1,1,0]]],Z:[[[1,1,0],[0,1,1]],[[0,0,1],[0,1,1],[0,1,0]],[[0,0,0],[1,1,0],[0,1,1]],[[0,1,0],[1,1,0],[1,0,0]]],S:[[[0,1,1],[1,1,0]],[[0,1,0],[0,1,1],[0,0,1]],[[0,0,0],[0,1,1],[1,1,0]],[[1,0,0],[1,1,0],[0,1,0]]],O:[[[0,1,1],[0,1,1]],[[0,1,1],[0,1,1]],[[0,1,1],[0,1,1]],[[0,1,1],[0,1,1]]]},cn=function(e){var n=rn[e.color][0].map((function(n,o){return Object(O.jsx)("tr",{children:n.map((function(n,o){return 0===n?Object(O.jsx)(on,{color:null},o):Object(O.jsx)(on,{color:e.color},o)}))},o)}));return Object(O.jsx)("li",{children:Object(O.jsx)("table",{children:Object(O.jsx)("tbody",{children:n})})})},an=o(28),sn=o.n(an),un=function(e){var n=e.player,o=Object(r.c)((function(e){return e.gameState2.opponentPieceQueue})),t=(Object(r.c)((function(e){return e.gameState2.myTurn})),0),N=[];if("mine"===n){if(Fe.isEmpty)return Object(O.jsx)("ul",{className:sn.a.pieceQueueMine});for(var c in Fe.elements)N.push(Object(O.jsx)(cn,{color:Fe.elements[c]},t++));return Object(O.jsx)(i.Fragment,{children:Object(O.jsx)("div",{className:sn.a.pieceQueueMine,children:Object(O.jsx)("ul",{children:N})})})}if("opponent"===n){if(!o||o.isEmpty)return Object(O.jsx)("ul",{className:sn.a.pieceQueueOpponent});for(var a in o)a&&N.push(Object(O.jsx)(cn,{color:o[a]},t++));return Object(O.jsx)(i.Fragment,{children:Object(O.jsx)("div",{className:sn.a.pieceQueueOpponent,children:Object(O.jsx)("ul",{children:N})})})}},ln=Object(i.memo)(un),jn=function(e){var n=e.player,o=Object(r.c)((function(e){return e.gameState2.opponentLinesCleared})),t=Object(r.c)((function(e){return e.gameState2.myLinesCleared}));return"opponent"===n?Object(O.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:o}):"mine"===n?Object(O.jsx)("div",{children:t}):void 0},dn=Object(i.memo)(jn),fn=function(){var e=Object(r.c)((function(e){return e.gameState2.gameRunning})),n=Object(r.c)((function(e){return e.gameState2.myTurn})),o=Object(r.c)((function(e){return e.userInfo.opponentName}));return e?n?Object(O.jsx)("div",{style:{textAlign:"center"},children:"Your Turn"}):Object(O.jsx)("div",{style:{textAlign:"center"},children:"".concat(o,"'s Turn")}):Object(O.jsx)("div",{style:{textAlign:"center"},children:" "})},bn=Object(i.memo)(fn),hn=function(){var e=Object(r.b)(),n=Object(r.c)((function(e){return e.gameState2.linesToClear})),o=Object(i.useState)(n),t=Object(c.a)(o,2),N=t[0],a=t[1];return Object(s.h)(Object(s.a)(Ke,"linesToClear"),(function(n){n.exists()&&e(We.setLinesToClear(n.val()))})),Object(O.jsxs)("div",{children:[Object(O.jsx)("label",{id:"lines",children:"Lines to Clear "}),Object(O.jsx)("input",{id:"lines",type:"number",value:N,onChange:function(e){N<=0||a(+e.target.value)}}),Object(O.jsx)("button",{onClick:function(){Object(s.d)(Object(s.a)(Ke,"linesToClear")),e(We.setLinesToClear(N)),Object(s.l)(Object(s.a)(Ke,"linesToClear"),N)},children:"set"}),Object(O.jsxs)("span",{children:[" Current amount is ",n]})]})},pn=!1,On=!1,mn=function(){var e=Object(r.b)(),n=Object(r.c)((function(e){return e.controls})),o=Object(r.c)((function(e){return e.gameState2.playerNumber})),t=Object(r.c)((function(e){return e.userInfo.opponentName})),N=Object(r.c)((function(e){return e.gameState2.myTurn})),c=Object(r.c)((function(e){return e.gameState2.displayMessage})),a=Object(r.c)((function(e){return e.gameState2.gameRunning})),u=Object(r.c)((function(e){return e.gameState2.currentGameStatus}));c.includes("WON")&&setTimeout((function(){pn=!1}),1e3),"FROZEN"===u&&(console.log("this occured"),e(We.unfreeze()),e(We.clearLines()),e(We.checkIfGameWon()),Object(s.l)(Object(s.a)(Ke,"turn"),1===o?2:1)),Object(i.useEffect)((function(){if(a)return Object(s.d)(Object(s.a)(Ke,"player".concat(1===o?2:1,"GameInfo"))),e(We.newGame()),function(){}}),[a]),Object(i.useEffect)((function(){if(a&&N){Object(s.d)(Object(s.a)(Ke,"grid")),e(We.getNewPiece(t)),e(We.placeCurrentPiece(t)),e(We.getGhostCoords()),e(We.showGhostPiece());var n=setInterval((function(){d()}),300),o=setInterval((function(){j()}),1),r=setInterval((function(){l()}),1);return function(){clearInterval(n),clearInterval(o),clearInterval(r)}}}),[N,a]);var l=function(){for(var o in je)je[o]&&(je[o]+=1);ue[n.softDrop]&&le[n.softDrop]&&je[n.softDrop]>40&&(e(We.dropPiece()),le[n.softDrop]=!0,je[n.softDrop]=30),ue[n.moveRight]&&le[n.moveRight]&&je[n.moveRight]>40&&(e(We.shiftRight()),e(We.getGhostCoords()),e(We.showGhostPiece()),le[n.moveRight]=!0,je[n.moveRight]=30),ue[n.moveLeft]&&le[n.moveLeft]&&je[n.moveLeft]>40&&(e(We.shiftLeft()),e(We.getGhostCoords()),e(We.showGhostPiece()),le[n.moveLeft]=!0,je[n.moveLeft]=30)},j=function(){var t=Object(C.a)(Object(P.a)().mark((function t(){return Object(P.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a&&!On){t.next=2;break}return t.abrupt("return");case 2:if(ue[n.rotateLeft]&&!le[n.rotateLeft]&&(e(We.rotatePiece(!0)),e(We.getGhostCoords()),e(We.showGhostPiece()),le[n.rotateLeft]=!0),ue[n.rotateRight]&&!le[n.rotateRight]&&(e(We.rotatePiece(!1)),e(We.getGhostCoords()),e(We.showGhostPiece()),le[n.rotateRight]=!0),!ue[n.hardDrop]||le[n.hardDrop]){t.next=13;break}return On=!0,e(We.hardDrop()),e(We.clearLines()),e(We.checkIfGameWon()),t.next=11,Object(s.l)(Object(s.a)(Ke,"turn"),1===o?2:1);case 11:le[n.hardDrop]=!0,setTimeout((function(){On=!1}),400);case 13:ue[n.softDrop]&&!le[n.softDrop]&&(je[n.softDrop]=1,e(We.dropPiece()),e(We.getGhostCoords()),e(We.showGhostPiece()),le[n.softDrop]=!0),ue[n.moveRight]&&!le[n.moveRight]&&(je[n.moveRight]=1,e(We.shiftRight()),e(We.getGhostCoords()),e(We.showGhostPiece()),le[n.moveRight]=!0),ue[n.moveLeft]&&!le[n.moveLeft]&&(je[n.moveLeft]=1,e(We.shiftLeft()),e(We.getGhostCoords()),e(We.showGhostPiece()),le[n.moveLeft]=!0);case 16:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),d=function(){var n=Object(C.a)(Object(P.a)().mark((function n(){return Object(P.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e(We.dropPiece()),e(We.getGhostCoords()),e(We.showGhostPiece());case 3:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),f=function(){var e=Object(C.a)(Object(P.a)().mark((function e(){return Object(P.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(s.l)(Object(s.a)(Ke,"displayMessage"),"READY"),e.next=3,new Promise((function(e){return setTimeout(e,500)}));case 3:return Object(s.l)(Object(s.a)(Ke,"displayMessage"),"GO"),e.next=6,new Promise((function(e){return setTimeout(e,500)}));case 6:return e.next=8,Object(s.l)(Object(s.a)(Ke,"grid"),[["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"]]);case 8:return e.next=10,Object(s.l)(Object(s.a)(Ke,"displayMessage"),"in game");case 10:return e.next=12,Object(s.l)(Object(s.a)(Ke,"/turn"),1===o?2:1);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(s.g)(Object(s.a)(G,L.currentUser.uid+"/inRoom")).set(!1),c.includes("WON")||Object(s.h)(Object(s.a)(Ke,"displayMessage"),(function(n){n.exists()&&(e(We.setDisplayMessage(n.val())),"READY"===n.val()&&(e(We.gettingReady()),pn=!0))})),a&&!N&&Object(s.h)(Object(s.a)(Ke,"grid"),(function(n){n.exists()&&e(We.setGrid(n.val()))})),a&&!N&&Object(s.h)(Object(s.a)(Ke,"player".concat(o,"GameInfo/linesCleared")),(function(n){e(We.setMyLinesCleared(n.val()))})),Object(s.h)(Object(s.a)(Ke,"player".concat(1===o?2:1,"GameInfo")),(function(n){n.exists()&&e(We.setOpponentInfo({opponentPieceQueue:n.val().gameQueue,opponentLinesCleared:n.val().linesCleared}))})),Object(s.h)(Object(s.a)(Ke,"turn"),(function(n){n.exists()&&e(We.setMyTurn(n.val()===o))})),document.onkeydown=function(e){pn||e.key===n.newGame&&(pn=!0,f())},Object(O.jsxs)(i.Fragment,{children:[Object(O.jsx)(de,{}),Object(O.jsx)(bn,{}),Object(O.jsxs)("div",{style:{display:"flex",flexWrap:"nowrap"},children:[Object(O.jsx)(dn,{player:"opponent"}),Object(O.jsx)(ln,{player:"opponent"}),Object(O.jsx)(Nn,{}),Object(O.jsx)(ln,{player:"mine"}),Object(O.jsx)(dn,{player:"mine"})]}),!a&&Object(O.jsx)(hn,{}),Object(O.jsxs)("div",{style:{color:"yellow"},children:[Object(O.jsx)("p",{children:"How To Play:"}),Object(O.jsx)("p",{children:"Press esc to start."}),Object(O.jsx)("p",{children:"Game starts with other person first."}),Object(O.jsx)("p",{children:"After player drops piece, other player goes."}),Object(O.jsx)("p",{children:"Person that causes the board to overflow loses a line point."}),Object(O.jsx)("p",{children:"Play until a person clears an amount of lines."})]})]})},yn=Object(i.memo)(mn),gn=function(){var e=Object(r.b)(),n=Object(r.c)((function(e){return e.userInfo.roomStatus})),o=Object(r.c)((function(e){return e.gameState2.playerNumber})),t=Object(r.c)((function(e){return e.userInfo.roomKey}));t&&Object(s.g)(Object(s.a)(R,t)).remove(),Object(s.h)(G,(function(){L.currentUser&&Object(s.b)(G).then((function(n){n.val()&&e(_e.setOtherUsers(Object.entries(n.val()).filter((function(e){return e[0]!==L.currentUser.uid&&!e[1].inRoom}))))}))})),t&&Object(s.h)(Object(s.a)(R,t+"/accepted"),(function(n){n.exists()&&(n.val()?2!==o&&(e(We.setMultiplayer({playerNumber:1,roomRef:Object(s.a)(R,t)})),e(_e.setRoomStatus("in room")),Object(s.l)(Object(s.a)(G,L.currentUser.uid+"/inRoom"),!0)):e(_e.setRoomStatus("waiting")))})),Object(s.e)(R,(function(){L.currentUser&&Object(s.b)(R).then((function(n){n.exists()&&e(_e.setInvitiationKeys(Object.entries(n.val()).filter((function(e){return!e[1].accepted&&e[1].player2===L.currentUser.uid})).map((function(e){return{opponentuid:e[1].player1,roomKey:e[0]}}))))}))})),Object(s.f)(R,(function(){L.currentUser&&Object(s.b)(R).then((function(n){n.exists()?e(_e.setInvitiationKeys(Object.entries(n.val()).filter((function(e){return!e[1].accepted&&e[1].player2===L.currentUser.uid})).map((function(e){return{opponentuid:e[1].player1,roomKey:e[0]}})))):e(_e.setInvitiationKeys([]))}))}));var N=Object(r.c)((function(e){return e.userInfo.opponentID})),c=function(){var n=Object(C.a)(Object(P.a)().mark((function n(){return Object(P.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return Object(s.d)(Object(s.a)(G,N)),e(We.reset()),n.next=4,Object(s.k)(Object(s.a)(R,t));case 4:e(_e.reset()),L.currentUser&&Object(s.l)(Object(s.a)(G,L.currentUser.uid+"/inRoom"),!1);case 6:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return N&&Object(s.h)(Object(s.a)(G,N),function(){var e=Object(C.a)(Object(P.a)().mark((function e(n){var o;return Object(P.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.exists()){e.next=4;break}c(),e.next=9;break;case 4:if(!n.val().inRoom){e.next=9;break}return o=!1,e.next=8,Object(s.b)(Object(s.a)(Ke,"accepted")).then((function(e){o=e.val()}));case 8:o||c();case 9:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),"in room"===n&&Object(s.h)(Ke,(function(n){n.exists()||(Object(s.d)(Object(s.a)(R,t)),Object(s.d)(Object(s.a)(G,N)),e(_e.reset()),L.currentUser&&Object(s.l)(Object(s.a)(G,L.currentUser.uid+"/inRoom"),!1),e(We.reset()))})),Object(O.jsxs)(i.Fragment,{children:[Object(O.jsx)("h1",{children:"Ditris Two-Player"}),"looking for room"===n&&Object(O.jsx)(Ye,{}),"looking for room"===n&&Object(O.jsx)(Ie,{}),"waiting"===n&&Object(O.jsx)(Te,{cancelRoomHandler:c}),Object(O.jsx)(Se,{}),"in room"===n&&Object(O.jsx)(Ve,{leaveRoomHandler:c}),"in room"===n&&Object(O.jsx)(yn,{})]})},vn=o(49),xn=o.n(vn),Pn=function(e){var n=e.setPage,o=e.setShowKeyBindings;return Object(O.jsxs)("ul",{className:xn.a["nav-bar"],children:[Object(O.jsx)("li",{onClick:function(){n("singleplayer")},children:"SinglePlayer"}),Object(O.jsx)("li",{onClick:function(){n("two-player")},children:"Two-Player"}),Object(O.jsx)("li",{onClick:function(){o(!0)},style:{float:"right"},children:"Set Controls"})]})},Cn=function(){var e=Object(r.b)(),n=Object(i.useState)(Object(O.jsx)(ve,{})),o=Object(c.a)(n,2),t=o[0],N=o[1],l=Object(i.useState)(!1),j=Object(c.a)(l,2),d=j[0],f=j[1];return Object(a.b)(L,(function(n){n?(e(_e.login()),e(_e.reset()),e(_e.setRoomStatus("looking for room"))):(e(_e.logout()),Le&&Object(s.d)(Le),e(_e.reset()))})),Object(O.jsxs)(u.a.Fragment,{children:[Object(O.jsx)(Pn,{setPage:function(n){"singleplayer"===n?(e(H.reset()),N(Object(O.jsx)(ve,{}))):"two-player"===n&&(Ke&&Object(s.k)(Ke),e(We.reset()),N(Object(O.jsx)(gn,{})))},setShowKeyBindings:f}),t,d&&Object(O.jsx)(x,{setShowKeyBindings:f})]})},Sn=Object(l.a)({reducer:{gameState:z,userInfo:Ge,gameState2:qe,controls:f}});N.a.createRoot(document.getElementById("root")).render(Object(O.jsx)(r.a,{store:Sn,children:Object(O.jsx)(Cn,{})}))}},[[64,1,2]]]);
//# sourceMappingURL=main.9c7f2159.chunk.js.map